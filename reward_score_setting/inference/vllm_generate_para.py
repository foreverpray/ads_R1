import json
import os
from vllm import LLM, SamplingParams
from transformers import AutoTokenizer
from datasets import load_dataset
import gc

model_id = "/gpfs/deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B"

tokenizer = AutoTokenizer.from_pretrained(model_id)
llm = LLM(
    model=model_id,
    max_model_len=30000,
    gpu_memory_utilization=0.98,
    trust_remote_code=True,
    tensor_parallel_size=1
)

sampling_params = SamplingParams(
    temperature=0.7,
    top_p=0.95,
    max_tokens=22000
)

batch_questions = ["小红书文案撰写策略\n- 使用吸引人的标题\n- 描述商品具体的成果和效果，强调标题中的关键词，使其更具吸引力\n- 使用惊叹号、省略号等标点符号增强表达力，营造紧迫感和惊喜感\n- 使用emoji表情符号，来增加文字的活力 \n- 采用具有挑战性和悬念的表述，引发读者好奇心 \n- 蹭热点，蹭高热度话题，使用爆款词，高热度名词 \n- 尽量使用缩略词、习语、过渡短语、感叹词、修饰语和常用语，避免重复短语和不自然的句子结构\n- 需要吸引用户的眼球，从而增加营销的成功率 \n- 以口语化的表达方式，来拉近与读者的距离，但不要直接使用第一人称“我”\n\n### 网络热点：\n“这爱的城市虽然拥挤”这个话题源于一首歌曲《爱笑的眼睛》中的歌词。这首歌由著名歌手林俊杰演唱，在网络上引起了广泛的关注和讨论。这个话题在社交媒体平台上迅速传播开来，吸引了大量网友参与其中。大家纷纷用“这爱的城市虽然拥挤”来表达自己对爱情的期待和渴望，在繁忙的都市生活中寻找真爱的信念。这个话题的影响逐渐扩大，引发了人们对现代城市生活和爱情的思考。通过这个话题，人们不仅分享了自己的故事和心情，也感受到了来自陌生人的温暖和支持。总的来说，“这爱的城市虽然拥挤”这个话题以其贴近现实生活和触动人心的情感表达，成为了网络上的热门话题之一。\n\n### 品牌商品信息：\n## 基本信息\n八八坑道1999清香43度500mL是一款产自中国台湾的白酒。它采用优质高粱为原料，经过传统固态发酵工艺酿制而成，具有清香型白酒的典型风格。其酒精度数为43度，容量为500毫升。这款酒在1999年生产，因此得名“1999”。八八坑道1999清香43度500mL口感醇厚，香气浓郁，适合品鉴和收藏。\n\n## 商品特色和亮点\n八八坑道1999清香43度500mL的特色和卖点：\n1. 产地：来自中国台湾，具有地方特色。\n2. 原料：选用优质水、高粱、小麦为原料，保证酒的品质。\n3. 口感：酒体清香纯正，入口诸味协调，落喉丰满绵柔，饮后回味爽净。\n4. 包装：采用纯色流畅型瓶身，设计简单大气，适合商务宴请、家庭聚会、节日赠礼、自饮小酌等各种场合。\n5. 价格：性价比较高，适合大众消费。\n\n## 目标消费者和市场\n八八坑道1999清香43度500mL的目标消费者和市场：\n八八坑道1999清香43度500mL是一款清香型白酒，适合商务宴请、家庭聚会、节日赠礼、自饮小酌等场合。因此，其目标消费者主要是喜欢清香型白酒的成年消费者，尤其是商务人士、家庭聚会组织者、节日送礼者和自饮爱好者。此外，由于这是一款台湾产的白酒，因此其在台湾市场以及接受台湾文化的市场具有较高的知名度。请结合上面给定的“小红书文案撰写策略”“网络热点”和“品牌商品信息”，撰写一段适合在小红书平台上发布的宣传帖子并生成标题。要求标题简洁明了、有吸引力，帖子正文符合小红书平台的风格调性，从网络热点出发，紧紧围绕品牌形象或商品特点，最大限度的体现营销文案的创意。整体字数不超过200字，不能照搬前面的参考资料，格式如下：\n标题: yyyy\n帖子正文: xxxxxxxx\n标签: zzz\n",
"微博文案特点：\n短小精悍：由于微博的字数限制，微博文案通常短小精悍，言简意赅；\n主题明确：要保持与品牌形象一致的风格和调性，强调产品或服务的独特卖点，提供有价值的信息；\n即时性强：微博文案需要紧跟时事热点和社会话题，及时传递最新的信息和动态；\n个性化表达：微博文案的写作风格和表达方式各具特色，个性化十足；\n互动性强：可以在文案中鼓励读者发表自己的观点或分享自己的经验，以增加互动性；\n标签格式：#xxx#\n\n-----\n网络热点：\n近期，在2024LPL春季赛季后赛中，NIP战队成功战胜了WE战队，晋级到下一轮比赛。此场比赛的焦点在于决胜局时，Rookie选手拿出龙王英雄，凭借出色的发挥，完成了四杀，为NIP战队锁定了胜局。赛后，宁(Ning)高度评价Rookie为NIP的\"救世主\"。这一胜利在网络上引起了热议，许多粉丝对Rookie的表现赞叹不已，并期待他在接下来的比赛中的表现。此次胜利无疑提升了NIP在LPL春季赛季后赛中的地位和影响力，也为他们争取更好的成绩打下了坚实的基础。\n\n-----\n品牌商品信息：\n## 基本信息\n魏酒师贵州酱香型白酒桶装53度原浆老酒纯粮食自酿5斤 整箱装泡酒市场参考价为87.80元。这款酒经常在婚宴，纪念日，聚会，喜宴，宴请，自饮等场合饮用。魏酒师贵州酱香型白酒桶装53度原浆老酒纯粮食自酿5斤 整箱装泡酒经常在婚宴，纪念日，聚会，喜宴，宴请，自饮等场合饮用。\n\n## 商品特色和亮点\n魏酒师贵州酱香53度原浆老酒5斤装的特色和卖点：\n1. 产地：产自贵州省，中国著名的酱香型白酒产区。\n2. 原料：采用优质高粱、小麦等纯粮食原料，保证酒的品质。\n3. 工艺：遵循传统酿酒工艺，经过多次蒸煮、发酵、蒸馏等工序，酿造出独特的酱香风味。\n4. 度数：53度，属于高度白酒，口感浓烈，适合喜欢喝高度酒的酒友。\n5. 容量：5斤装，大容量，适合家庭聚会、朋友聚餐等场合。\n6. 用途：除了直接饮用外，还可以用于泡酒，制作药酒、果酒等。\n7. 价格：性价比较高，参加促销活动后，每件仅需69.7元。\n\n## 目标消费者和市场\n魏酒师贵州酱香53度原浆老酒5斤装的目标消费者和市场：\n魏酒师贵州酱香53度原浆老酒5斤装是一款面向中高端消费者的酱香型白酒。它的目标市场主要是那些追求高品质生活、注重健康饮酒、对白酒口感和品质有较高要求的消费者。此外，由于这款酒具有53度的酒精含量，它可能更受那些喜欢高度数白酒、追求刺激口感的消费者的欢迎。同时，这款酒也适合作为礼品赠送给亲朋好友，因此礼品市场也是其重要的目标市场之一。\n\n结合上面给定的“微博文案特点”“网络热点”和“品牌商品信息”，撰写一段适合在微博平台上发布的帖子并生成标题和标签。要求标题简洁明了、有吸引力，帖子正文符合微博平台的风格调性，从网络热点出发，紧紧围绕品牌形象或商品特点，最大限度的体现营销文案的创意。正文最后需要添加3-5个与品牌或热点相关的标签。整体字数不超过200字，不能照搬前面的参考资料，格式如下：\n标题: yyyy\n帖子正文: xxxxxxxx\n标签: zzz\n",
"抖音文案特点：\n短小精悍：由于时长限制，文案需要简洁明了，迅速引起观众的兴趣；\n节奏紧凑：要尽可能地精炼和浓缩内容，避免冗长和复杂的句子；\n语言生动有力：为了吸引观众的注意力，通常使用生动有力、富有感染力的语言，包括网络热梗或流行语等；\n情感共鸣：文案能够引发观众的情感共鸣，使观众产生强烈的认同感和情感联系；\n创意独特：无论是情节设计、角色设定还是语言表达，都需要有新颖独特的元素；\n视觉优先：抖音短视频文案更注重视觉效果和表现力。文案需要与视频内容相配合，通过视觉元素来传达信息和情感；\n引导互动：抖音短视频文案有时会包含引导观众互动的元素，如提问、挑战、话题标签等。这些元素可以激发观众的参与热情，提高视频的互动性和分享率；\n标签格式为：#xxx\n\n-----\n网络热点：\n近期，在青岛出现了令人惊叹的超低空糙面云，这一景象不仅美得让人窒息，更引人注目的是，有无人机居然能够穿越这些云层。这组照片在朋友圈迅速传播开来，引发了广大网友的关注和热议。这种罕见的现象被称为\"珠母云\"，通常只在高纬度地区的高空才能看到。此次出现的糙面云给人们带来了震撼的视觉体验，同时也让人们对自然奇观产生了更深的兴趣与探索欲望。\n\n-----\n品牌商品信息：\n## 基本信息\n汾阳王53度清香型白酒3斤装是一款产自山西的名酒，属于汾阳王系列。这款白酒的酒精度数为53度，容量为3斤，即1500毫升，适合喜欢高度酒的酒友。汾阳王53度清香型白酒3斤装采用优质的原料和传统的酿造工艺制作而成，口感清香纯正，回味悠长。这款酒在市面上有着良好的口碑和销量，是白酒爱好者们不可错过的一款佳酿。\n\n## 商品特色和亮点\n汾阳王53度清香型白酒3斤装的特色和卖点：\n1. 产地优势：产自中国白酒之乡山西汾阳，拥有得天独厚的地理环境和酿酒历史。\n2. 清香型白酒：属于清香型白酒，具有清香纯正、醇甜柔和、自然协调、余味净爽的特点。\n3. 高品质原料：选用优质高粱、大麦、豌豆等为原料，遵循传统工艺酿造。\n4. 53度高度酒：53度的酒精含量，适合喜欢高度酒的消费者。\n5. 3斤装大容量：3斤装的大容量设计，适合家庭聚会、朋友聚餐等场合。\n6. 品牌影响力：汾阳王品牌在中国白酒市场有一定的知名度和影响力，品质有保障。\n\n## 目标消费者和市场\n汾阳王53度清香型白酒3斤装的目标消费者和市场主要是喜欢清香型白酒的消费者，特别是那些追求高品质、健康饮酒习惯的消费者。此外，汾阳王53度清香型白酒3斤装也适合用于商务宴请、礼品赠送等场合。在市场布局上，汾阳王以长三角、珠三角为代表的经济发达地区作为清香白酒的主战场，这些区域的消费者对于清香白酒的认知度和接受度不断提升，清香白酒的市场份额也在持续增长。\n\n结合上面给定的“抖音文案特点”“网络热点”和“品牌商品信息”，撰写一段适合在抖音平台上发布的视频文案并生成标题和标签。要求标题简洁明了、有吸引力，文案内容符合抖音平台的风格和调性，紧紧围绕品牌形象或商品特点，最大限度的体现营销文案的创意。最后需要添加3-5个与品牌或热点相关的标签。文案字数不超过200字，不能照搬前面的参考资料，格式如下：\n标题: yyyy\n帖子正文: xxxxxxxx\n标签: zzz",
]
batch_input_ids = []
for question in batch_questions:
    messages = [{"role": "user", "content": question}]
    input_id = tokenizer.apply_chat_template(messages, tokenize=False, add_generation_prompt=True)
    batch_input_ids.append(input_id)

# 传递给模型进行推理
outputs = llm.generate(batch_input_ids, sampling_params)

# 写入文件

for output in outputs:
    print(output.outputs[0].text)

